---

copyright:
  years: 2017
lastupdated: "2017-11-09"

---


{:new_window: target="_blank"}
{:shortdesc: .shortdesc}
{:screen: .screen}
{:codeblock: .codeblock}
{:pre: .pre}

# キーおよび秘密の管理
{: #keys_secrets}

API が API Management によって管理されている場合、キーおよび秘密を使用して、API へのアクセスを制御できます。

## キーおよび秘密の作成
{: #create_key_secret}

API にキーを追加するには、以下のステップを実行します。

1. Cloud Foundry アプリケーションまたは OpenWhisk API を開きます (まだ開いていない場合)。

2. ナビゲーションで*「API Management」*を選択します。

3. 「共有およびキー」タブを選択して、そのアプリケーションまたは API のキーにアクセスします。 *注: アプリケーションまたは API を初めて保存するまで、このタブは表示されません。*

4. **「管理対象 API の公開」**スライダーが*オン* の位置に設定されていることを確認します。 キーを割り当てるには、事前に API を公開しておく必要があります。

5. {{site.data.keyword.Bluemix_notm}} 組織へのアクセス権限を持つ利用者用のキーを作成します。
  1. *「{{site.data.keyword.Bluemix_notm}} 組織内での共有 (Sharing within Bluemix Organization)」*セクション内で**「API キーの作成 +」**を選択します。 キーおよび秘密が自動的に作成され、正しいフィールドに入力されます。 キーも、このタイプのキーの秘密も、更新することはできません。 
  2. 識別するのに役立つように、キーと秘密の名前を入力します。 例えば、それを使用する利用者の名前を入力します。
  3. **「保存」**をクリックして、新規キーを保存します。
  4. 追加のキーが必要な場合は、ステップ *a* から *c*までを繰り返して追加できます。 API ごとに、このセクションで最大 5 つのキーを持つことができます。

6. {{site.data.keyword.Bluemix_notm}} 組織のメンバーではない利用者用のキーを作成します。
  1. *「{{site.data.keyword.Bluemix_notm}} 組織の外部での共有 (Sharing Outside of Bluemix Organization)」*セクション内で**「API キーの作成 +」**を選択します。 キーが自動的に作成され、正しいフィールドに入力されます。 このタイプのキーでは、最初に表示される秘密はありません。 キーは更新できません。 
  2. 識別するのに役立つように、キーの名前を入力します。 例えば、それを使用する利用者の名前を入力します。
  3. オプション: キーに秘密を追加する場合は、秘密を追加したいキーの**「API ポータル・リンク」**を選択し、**「API の秘密の設定 (Set API Secret)」**を選択します。
  4. **「保存」**をクリックして、新規キーを保存します。
  5. 追加のキーが必要な場合は、ステップ *a* から *d*までを繰り返して追加できます。 API ごとに、このセクションで最大 5 つのキーを持つことができます。
「共有およびキー」タブを選択すると、API のキーがリストされます。

## API 呼び出しでのキーおよび秘密の指定
{: #spec_key_secret}

利用者は、正しいキー、秘密、またはその両方を呼び出しのヘッダーに含めた場合のみ、API を呼び出すことができます。 API を呼び出すには、利用者は、以下の例に示すように API 呼び出しにキーと秘密を含める必要があります。
```
curl --request PUT \
  --url https://appidtest.mybluemix.net/ \
  --header 'accept: application/json' \
  --header 'content-type: application/json' \
  --header 'x-ibm-client-secret: add_secret_here' \
  --data '{"id":999999999999999}'
```
{: codeblock}
*add_secret_here* は、正しいキーの秘密に置き換えられます。 

## API キーの削除
{: #delete_key}

ある時点で、キーを削除したい場合があります。 API を使用していた利用者が、独自の API を作成し、それまでの API が不要になることが考えられます。 どの利用者もそれまでの API を使用しなくなるようにするため、キーを削除することができます。 サービスからキーを削除するには、以下のステップを実行します。

1. Cloud Foundry アプリケーションまたは OpenWhisk API を開きます (まだ開いていない場合)。

2. ナビゲーションで*「API Management」*を選択します。

3. *「共有およびキー」*タブを選択します。

4. 削除するキーを見つけます。 ヒント: このときに、識別しやすいようにキーに付けた名前が役立ちます。

5. 削除するキーの横にあるオプション・アイコン (垂直に並んだ 3 つのドット) を選択します。 

6. **「キーの削除」**を選択します。

7. 削除を確認して、キーを削除します。
